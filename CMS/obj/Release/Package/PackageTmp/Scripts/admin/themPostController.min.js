myApp.controller("themPostController",["$scope","$http","$window","$location","$filter","Alias","MenuMultiLevel","Url",function(n,t,i,r,u,f,e,o){n.post={};n.categories=[];n.category={};n.chooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.post.image=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.currentIdPost=o.getParameterByName("idPost");n.currentIdPost?t.get("/API/PostsAPI/"+n.currentIdPost).success(function(t){n.post={idPost:t.idPost,idCategory:t.idCategory,idUserCreated:t.idUserCreated,idUserModified:t.idUserModified,timeCreated:t.timeCreated,timeModified:t.timeModified,title:t.title,alias:t.alias,content:t.content,note:t.note,description:t.description,published:t.published,image:t.image,tags:t.tags,version:t.version,deleted:t.deleted,featured:t.featured,metadescription:t.metadescription,metakewords:t.metakewords,author:t.author,robots:t.robots};n.category={id:t.idCategory}}):(n.post={published:1,featured:0,robots:"Index, Follow",idUserCreated:angular.element("#user").val(),timeCreated:new Date,idUserModified:angular.element("#user").val(),timeModified:new Date},n.category={id:1});t.get("/API/CategoriesAPI/").success(function(t){n.categories=e.getDropdownMenu(t)});n.savePost=function(){n.post.idCategory=n.category.id;n.currentIdPost?(n.post.idUserModified=angular.element("#user").val(),n.post.timeModified=new Date,t.put("/API/PostsAPI/"+n.post.idPost,n.post).success(function(){toastr.success("Thành công","Lưu Bài viết")}).error(function(){toastr.error("Thất bại","Thêm Bài viết")})):t.post("/API/PostsAPI/",n.post).success(function(){toastr.success("Thành công","Thêm Bài viết");i.location.href="/Admin/Posts"}).error(function(){toastr.error("Thất bại","Thêm Bài viết")})};n.savePostAndExit=function(){n.post.idCategory=n.category.id;n.currentIdPost?(n.post.idUserModified=angular.element("#user").val(),n.post.timeModified=new Date,t.put("/API/PostsAPI/"+n.post.idPost,n.post).success(function(){i.location.href="/Admin/Posts"}).error(function(){toastr.error("Thất bại","Lưu Bài viết")})):t.post("/API/PostsAPI/",n.post).success(function(){i.location.href="/Admin/Posts"}).error(function(){toastr.error("Thất bại","Thêm Bài viết")})};n.savePostAndNew=function(){n.post.idCategory=n.category.id;n.currentIdPost?(n.post.idUserModified=angular.element("#user").val(),n.post.timeModified=new Date,t.put("/API/PostsAPI/"+n.post.idPost,n.post).success(function(){i.location.href="/Admin/Posts/Create"}).error(function(){toastr.error("Thất bại","Lưu Danh mục")})):t.post("/API/PostsAPI/",n.post).success(function(){i.location.href="/Admin/Posts/Create"}).error(function(){toastr.error("Thất bại","Thêm Bài viết")})};n.cancel=function(){i.location.href="/Admin/Posts"};n.changeTitle=function(){n.post.alias=f.genAlias(n.post.title)}}]);