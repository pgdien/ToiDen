myApp.controller("themCategoryController",["$scope","$http","$window","$location","$filter","Alias","MenuMultiLevel","Url",function(n,t,i,r,u,f,e,o){n.category={};n.categoryParents=[];n.categoryParent={};n.currentIdCategory=o.getParameterByName("idCategory");n.chooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.category.image=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.chooseImageBanner=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.category.image_banner=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.currentIdCategory?t.get("/API/CategoriesAPI/"+n.currentIdCategory).success(function(t){n.category={idCategory:t.idCategory,idCategoryParent:t.idCategoryParent,idUserCreated:t.idUserCreated,idUserModified:t.idUserModified,timeCreated:t.timeCreated,timeModified:t.timeModified,title:t.title,alias:t.alias,note:t.note,description:t.description,published:t.published,image:t.image,image_banner:t.image_banner,color_background_banner:t.color_background_banner,color_title_banner:t.color_title_banner,color_text_banner:t.color_text_banner,tags:t.tags,version:t.version,deleted:t.deleted,metadescription:t.metadescription,metakewords:t.metakewords,author:t.author,robots:t.robots};n.categoryParent={id:t.idCategoryParent}}):(n.category={published:1,robots:"Index, Follow",idUserCreated:angular.element("#user").val(),timeCreated:new Date,idUserModified:angular.element("#user").val(),timeModified:new Date},n.categoryParent={id:1});t.get("/API/CategoriesAPI/").success(function(t){n.categoryParents=e.getDropdownMenu(t)});n.saveCategory=function(){n.category.idCategoryParent=n.categoryParent.id;n.currentIdCategory?(n.category.idUserModified=angular.element("#user").val(),n.category.timeModified=new Date,t.put("/API/CategoriesAPI/"+n.category.idCategory,n.category).success(function(){toastr.success("Thành công","Lưu Danh mục");t.get("/API/CategoriesAPI/").success(function(t){n.categoryParents=e.getDropdownMenu(t);n.$apply})}).error(function(){toastr.error("Thất bại","Thêm Danh mục")})):t.post("/API/CategoriesAPI/",n.category).success(function(){toastr.success("Thành công","Thêm Danh mục");i.location.href="/admin/categories"}).error(function(){toastr.error("Thất bại","Thêm Danh mục")})};n.saveCategoryAndExit=function(){n.category.idCategoryParent=n.categoryParent.id;n.currentIdCategory?(n.category.idUserModified=angular.element("#user").val(),n.category.timeModified=new Date,t.put("/API/CategoriesAPI/"+n.category.idCategory,n.category).success(function(){i.location.href="/admin/categories"}).error(function(){toastr.error("Thất bại","Lưu Danh mục")})):t.post("/API/CategoriesAPI/",n.category).success(function(){i.location.href="/admin/categories"}).error(function(){toastr.error("Thất bại","Thêm Danh mục")})};n.saveCategoryAndNew=function(){n.category.idCategoryParent=n.categoryParent.id;n.currentIdCategory?(n.category.idUserModified=angular.element("#user").val(),n.category.timeModified=new Date,t.put("/API/CategoriesAPI/"+n.category.idCategory,n.category).success(function(){i.location.href="/admin/categories/Create"}).error(function(){toastr.error("Thất bại","Lưu Danh mục")})):t.post("/API/CategoriesAPI/",n.category).success(function(){i.location.href="/admin/categories/Create"}).error(function(){toastr.error("Thất bại","Thêm Danh mục")})};n.cancel=function(){i.location.href="/admin/categories"};n.changeTitle=function(){n.category.alias=f.genAlias(n.category.title)}}]);